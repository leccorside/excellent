{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { HttpClient } from '@angular/common/http';\nimport consultarCNPJ from \"consultar-cnpj\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\n\nfunction ClienteListComponent_tr_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const cliente_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cliente_r2.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cliente_r2.razao_social);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cliente_r2.cnpj);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cliente_r2.email);\n  }\n}\n\nfunction ClienteListComponent_div_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \"CNPJ INV\\u00C1LIDO!\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let ClienteListComponent = /*#__PURE__*/(() => {\n  class ClienteListComponent {\n    constructor(http) {\n      this.http = http;\n      this.clientes = [];\n      this.cliente = {\n        cnpj: '',\n        razao_social: '',\n        email: ''\n      };\n      this.cnpjInvalido = false;\n    }\n\n    ngOnInit() {\n      this.http.get('http://localhost:3000/clientes').subscribe(data => {\n        this.clientes = data;\n      });\n    }\n\n    consultarCNPJ() {\n      return __awaiter(this, void 0, void 0, function* () {\n        if (this.cliente.cnpj) {\n          const token = \"INFORME O SEU TOKEN DE ACESSO\";\n\n          try {\n            const empresa = yield consultarCNPJ(this.cliente.cnpj);\n\n            if (empresa && empresa.razao_social) {\n              console.log(\"Dados retornados:\", empresa);\n              this.cnpjInvalido = false;\n              this.cliente.razao_social = empresa.razao_social;\n              this.cliente.email = empresa.estabelecimento.email || '';\n            } else {\n              this.definirCNPJInvalido();\n            }\n          } catch (error) {\n            this.definirCNPJInvalido();\n            console.error(\"Erro ao consultar CNPJ:\", error);\n          }\n        }\n      });\n    }\n\n    definirCNPJInvalido() {\n      this.cnpjInvalido = true;\n      this.cliente.razao_social = '';\n      this.cliente.email = '';\n    }\n\n    onSubmit() {\n      if (!this.cnpjInvalido) {\n        this.http.post('http://localhost:3000/clientes', this.cliente).subscribe(response => {\n          console.log('Cliente cadastrado com sucesso!'); // Recarregar a lista de clientes\n\n          this.ngOnInit();\n          this.resetForm();\n          this.closeModal();\n        }, error => {\n          console.error('Erro ao cadastrar cliente:', error);\n        });\n      }\n    }\n\n    resetForm() {\n      this.cliente = {\n        cnpj: '',\n        razao_social: '',\n        email: ''\n      };\n      this.cnpjInvalido = false;\n    }\n\n    closeModal() {\n      const modalElement = document.getElementById('cadastroClienteModal');\n\n      if (modalElement) {\n        const modal = window['bootstrap'].Modal.getInstance(modalElement);\n\n        if (modal) {\n          modal.hide();\n        }\n      }\n    }\n\n  }\n\n  ClienteListComponent.ɵfac = function ClienteListComponent_Factory(t) {\n    return new (t || ClienteListComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n  };\n\n  ClienteListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ClienteListComponent,\n    selectors: [[\"app-cliente-list\"]],\n    decls: 43,\n    vars: 5,\n    consts: [[1, \"container\", \"mt-4\"], [1, \"text-center\", \"mb-4\"], [\"data-bs-toggle\", \"modal\", \"data-bs-target\", \"#cadastroClienteModal\", 1, \"btn\", \"btn-primary\", \"mb-3\"], [1, \"table-responsive\"], [1, \"table\", \"table-striped\", \"table-bordered\"], [1, \"thead-dark\"], [4, \"ngFor\", \"ngForOf\"], [\"id\", \"cadastroClienteModal\", \"tabindex\", \"-1\", \"aria-labelledby\", \"cadastroClienteModalLabel\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"cadastroClienteModalLabel\", 1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [3, \"ngSubmit\"], [1, \"mb-3\"], [\"for\", \"cnpj\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"cnpj\", \"name\", \"cnpj\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\", \"input\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [\"for\", \"razao_social\", 1, \"form-label\"], [\"type\", \"text\", \"id\", \"razao_social\", \"name\", \"razao_social\", \"readonly\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"email\", 1, \"form-label\"], [\"type\", \"email\", \"id\", \"email\", \"name\", \"email\", \"readonly\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [1, \"text-danger\"]],\n    template: function ClienteListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n        i0.ɵɵtext(2, \"Lista de Clientes\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"button\", 2);\n        i0.ɵɵtext(4, \"Adicionar Cliente\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"table\", 4)(7, \"thead\", 5)(8, \"tr\")(9, \"th\");\n        i0.ɵɵtext(10, \"ID\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"th\");\n        i0.ɵɵtext(12, \"Raz\\u00E3o Social\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"th\");\n        i0.ɵɵtext(14, \"CNPJ\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"th\");\n        i0.ɵɵtext(16, \"Email\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(17, \"tbody\");\n        i0.ɵɵtemplate(18, ClienteListComponent_tr_18_Template, 9, 4, \"tr\", 6);\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(19, \"div\", 7)(20, \"div\", 8)(21, \"div\", 9)(22, \"div\", 10)(23, \"h5\", 11);\n        i0.ɵɵtext(24, \"Cadastro de Cliente\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(25, \"button\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"div\", 13)(27, \"form\", 14);\n        i0.ɵɵlistener(\"ngSubmit\", function ClienteListComponent_Template_form_ngSubmit_27_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(28, \"div\", 15)(29, \"label\", 16);\n        i0.ɵɵtext(30, \"CNPJ\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"input\", 17);\n        i0.ɵɵlistener(\"ngModelChange\", function ClienteListComponent_Template_input_ngModelChange_31_listener($event) {\n          return ctx.cliente.cnpj = $event;\n        })(\"input\", function ClienteListComponent_Template_input_input_31_listener() {\n          return ctx.consultarCNPJ();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(32, ClienteListComponent_div_32_Template, 2, 0, \"div\", 18);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"div\", 15)(34, \"label\", 19);\n        i0.ɵɵtext(35, \"Raz\\u00E3o Social\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"input\", 20);\n        i0.ɵɵlistener(\"ngModelChange\", function ClienteListComponent_Template_input_ngModelChange_36_listener($event) {\n          return ctx.cliente.razao_social = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(37, \"div\", 15)(38, \"label\", 21);\n        i0.ɵɵtext(39, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(40, \"input\", 22);\n        i0.ɵɵlistener(\"ngModelChange\", function ClienteListComponent_Template_input_ngModelChange_40_listener($event) {\n          return ctx.cliente.email = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(41, \"button\", 23);\n        i0.ɵɵtext(42, \"Salvar\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(18);\n        i0.ɵɵproperty(\"ngForOf\", ctx.clientes);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngModel\", ctx.cliente.cnpj);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.cnpjInvalido);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.cliente.razao_social);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.cliente.email);\n      }\n    },\n    directives: [i2.NgForOf, i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i2.NgIf],\n    styles: [\"\"]\n  });\n  return ClienteListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}